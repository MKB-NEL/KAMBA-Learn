<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Secure Login</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #2c3e50, #3498db);
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  .container {
    background: rgba(0,0,0,0.6);
    padding: 30px;
    border-radius: 10px;
    width: 300px;
    position: relative;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
    text-align: center;
  }
  h2 {
    margin-bottom: 20px;
  }
  input {
    width: 90%;
    padding: 10px;
    margin: 10px 0;
    border: none;
    border-radius: 5px;
  }
  button {
    padding: 10px 20px;
    margin-top: 10px;
    background: #27ae60;
    border: none;
    color: #fff;
    cursor: pointer;
    border-radius: 5px;
  }
  button:hover {
    background: #2ecc71;
  }
  #addUserBtn {
    position: absolute;
    left: 10px;
    bottom: 10px;
    background: #e67e22;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 20px;
    padding: 0;
  }
  #addUserBtn:hover {
    background: #d35400;
  }
  .youtube-btn {
    margin-top: 20px;
    background: #ff0000;
    display: inline-flex;
    align-items: center;
    border-radius: 5px;
    padding: 8px 12px;
    text-decoration: none;
    color: white;
    font-weight: bold;
  }
  .youtube-btn svg {
    margin-right: 8px;
  }
  .loading {
    display: none;
    margin-top: 10px;
  }
</style>
</head>
<body>
<div class="container">
  <h2>Sign In</h2>
  <form id="loginForm">
    <input type="text" id="username" placeholder="Username" required><br>
    <input type="password" id="password" placeholder="Password" required><br>
    <button type="submit">Login</button>
  </form>

  <div class="loading" id="loading">Loading...</div>
  <div id="errorMsg" style="color: red; margin-top: 10px;"></div>

  <a class="youtube-btn" href="https://www.youtube.com/@btemOfficial" target="_blank">
    <svg height="20" viewBox="0 0 24 24" width="20" fill="#fff">
      <path d="M19.615 3.184c-1.53-.41-7.615-.41-7.615-.41s-6.085 0-7.615.41A3.004 3.004 0 0 0 2.41 5.184C2 6.714 2 10.5 2 10.5s0 3.786.41 5.316a3.004 3.004 0 0 0 2.59 2c1.53.41 7.615.41 7.615.41s6.085 0 7.615-.41a3.004 3.004 0 0 0 2.59-2C22 14.286 22 10.5 22 10.5s0-3.786-.41-5.316a3.004 3.004 0 0 0-2.59-2zM9.75 13.5v-6l5.25 3-5.25 3z"/>
    </svg>
    KAMBA Codex â€” Subscribe for more
  </a>

  <button id="addUserBtn">+</button>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, query, where } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBbhxmAkHJtq3Zs17P4ewHsc8wi8-0M_XI",
    authDomain: "developers-imw.firebaseapp.com",
    projectId: "developers-imw",
    storageBucket: "developers-imw.firebasestorage.app",
    messagingSenderId: "182400720989",
    appId: "1:182400720989:web:dfa30c57dcd2c8c2c96db4",
    measurementId: "G-1VFTEWDBPG"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const loginForm = document.getElementById('loginForm');
  const loadingEl = document.getElementById('loading');
  const errorMsg = document.getElementById('errorMsg');

  // Login handling
  loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    loadingEl.style.display = 'block';
    errorMsg.textContent = '';

    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();

    try {
      const q = query(collection(db, "users"), where("username", "==", username), where("password", "==", password));
      const querySnapshot = await getDocs(q);
      loadingEl.style.display = 'none';
      if (!querySnapshot.empty) {
        window.location.href = "well.html";
      } else {
        errorMsg.textContent = "Invalid username or password.";
      }
    } catch (err) {
      loadingEl.style.display = 'none';
      errorMsg.textContent = "Error logging in: " + err.message;
    }
  });

  // Add user button
  document.getElementById('addUserBtn').addEventListener('click', async () => {
    const newUsername = prompt("Enter new username:");
    const newPassword = prompt("Enter new password:");
    if (newUsername && newPassword) {
      try {
        await addDoc(collection(db, "users"), {
          username: newUsername,
          password: newPassword
        });
        alert("User added successfully!");
      } catch (err) {
        alert("Error adding user: " + err.message);
      }
    }
  });
</script>
</body>
</html>
